<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">src/utils.js | Lazer Game Core</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<meta name="description" content="The core logic for lazer-game"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="Lazer Game Core"><meta property="twitter:description" content="The core logic for lazer-game"></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/rdfriedl/lazer-game-core"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-buildCollisions">buildCollisions</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-clipDecimals">clipDecimals</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-createName">createName</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getURLSearchSettings">getURLSearchSettings</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-lerp">lerp</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-parseSearch">parseSearch</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-COLLISION_GROUPS">COLLISION_GROUPS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-NAMES">NAMES</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-NAME_TEMPLATES">NAME_TEMPLATES</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#bullet">bullet</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/bullet/Bullet.js~Bullet.html">Bullet</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/bullet/BulletManager.js~BulletManager.html">BulletManager</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#bullet-types">bullet/types</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/bullet/types/DefaultBullet.js~DefaultBullet.html">DefaultBullet</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#game">game</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/game/Game.js~Game.html">Game</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#player">player</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/player/Player.js~Player.html">Player</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/player/PlayerManager.js~PlayerManager.html">PlayerManager</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#tilemap">tilemap</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/tilemap/Tilemap.js~Tilemap.html">Tilemap</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/utils.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import _clone from &quot;lodash/clone&quot;;
import p2 from &quot;p2&quot;;

export const NAME_TEMPLATES = [
	&quot;nice {{name}}&quot;,
	&quot;awesome {{name}}&quot;,
	&quot;{{name}} the cool&quot;,
	&quot;{{name}} the short&quot;,
	&quot;{{name}} the tall&quot;,
	&quot;{{name}} the fat&quot;,
	&quot;{{name}} the thin&quot;,
	&quot;{{name}} the scared&quot;,
	&quot;insane {{name}}&quot;,
	&quot;{{name}} the kid&quot;,
	&quot;really fat {{name}}&quot;,
	&quot;{{name}} the smart&quot;,
	&quot;{{name}} the brave&quot;,
	&quot;the amazing {{name}}&quot;,
	&quot;{{name}} the bald&quot;,
];
export const NAMES = [
	&quot;James&quot;,
	&quot;John&quot;,
	&quot;Robert&quot;,
	&quot;Michael&quot;,
	&quot;William&quot;,
	&quot;David&quot;,
	&quot;Richard&quot;,
	&quot;Charles&quot;,
	&quot;Joseph&quot;,
	&quot;Thomas&quot;,
	&quot;Christopher&quot;,
	&quot;Daniel&quot;,
	&quot;Paul&quot;,
	&quot;Mark&quot;,
	&quot;Donald&quot;,
	&quot;George&quot;,
	&quot;Kenneth&quot;,
	&quot;Steven&quot;,
	&quot;Edward&quot;,
	&quot;Brian&quot;,
	&quot;Ronald&quot;,
	&quot;Anthony&quot;,
	&quot;Kevin&quot;,
	&quot;Jason&quot;,
	&quot;Matthew&quot;,
	&quot;Gary&quot;,
	&quot;Timothy&quot;,
	&quot;Jose&quot;,
	&quot;Larry&quot;,
	&quot;Jeffrey&quot;,
	&quot;Frank&quot;,
	&quot;Scott&quot;,
	&quot;Eric&quot;,
	&quot;Stephen&quot;,
	&quot;Andrew&quot;,
	&quot;Raymond&quot;,
	&quot;Gregory&quot;,
	&quot;Joshua&quot;,
	&quot;Jerry&quot;,
	&quot;Dennis&quot;,
	&quot;Walter&quot;,
	&quot;Patrick&quot;,
	&quot;Peter&quot;,
	&quot;Harold&quot;,
	&quot;Douglas&quot;,
	&quot;Henry&quot;,
	&quot;Carl&quot;,
	&quot;Arthur&quot;,
	&quot;Ryan&quot;,
	&quot;Roger&quot;,
	&quot;Joe&quot;,
	&quot;Juan&quot;,
	&quot;Jack&quot;,
	&quot;Albert&quot;,
	&quot;Jonathan&quot;,
	&quot;Justin&quot;,
	&quot;Terry&quot;,
	&quot;Gerald&quot;,
	&quot;Keith&quot;,
	&quot;Samuel&quot;,
	&quot;Willie&quot;,
	&quot;Ralph&quot;,
	&quot;Lawrence&quot;,
	&quot;Nicholas&quot;,
	&quot;Roy&quot;,
	&quot;Benjamin&quot;,
	&quot;Bruce&quot;,
	&quot;Brandon&quot;,
	&quot;Adam&quot;,
	&quot;Harry&quot;,
	&quot;Fred&quot;,
	&quot;Wayne&quot;,
	&quot;Billy&quot;,
	&quot;Steve&quot;,
	&quot;Louis&quot;,
	&quot;Jeremy&quot;,
	&quot;Aaron&quot;,
	&quot;Randy&quot;,
	&quot;Howard&quot;,
	&quot;Eugene&quot;,
	&quot;Carlos&quot;,
	&quot;Russell&quot;,
	&quot;Bobby&quot;,
	&quot;Victor&quot;,
	&quot;Martin&quot;,
	&quot;Ernest&quot;,
	&quot;Phillip&quot;,
	&quot;Todd&quot;,
	&quot;Jesse&quot;,
	&quot;Craig&quot;,
	&quot;Alan&quot;,
	&quot;Shawn&quot;,
	&quot;Clarence&quot;,
	&quot;Sean&quot;,
	&quot;Philip&quot;,
	&quot;Chris&quot;,
	&quot;Johnny&quot;,
	&quot;Earl&quot;,
	&quot;Jimmy&quot;,
	&quot;Antonio&quot;,
];

export function createName() {
	return NAME_TEMPLATES[Math.floor(Math.random() * NAME_TEMPLATES.length)].replace(
		&quot;{{name}}&quot;,
		NAMES[Math.floor(Math.random() * NAMES.length)],
	);
}

export function lerp(v0, v1, t) {
	return v0 * (1 - t) + v1 * t;
}

export function parseSearch(url) {
	url = url || (window &amp;&amp; window.location.href);
	parseSearch.cache = parseSearch.cache || {};
	if (!parseSearch.cache[url]) {
		let search = url.indexOf(&quot;?&quot;) !== -1 ? url.substr(url.indexOf(&quot;?&quot;) + 1, url.length + 1) : &quot;&quot;;
		let queries = search
			.replace(/^\?/, &quot;&quot;)
			.replace(/\+/g, &quot; &quot;)
			.split(&quot;&amp;&quot;);
		parseSearch.cache[url] = {};
		for (let i = 0; i &lt; queries.length; i++) {
			let split = queries[i].split(&quot;=&quot;);
			if (split[0] !== &quot;&quot;) {
				let value = split[1];
				if (!isNaN(value)) value = parseFloat(value);
				else if (value === &quot;true&quot; || value === undefined || value === &quot;on&quot;) value = true;
				else if (value === &quot;false&quot; || value === &quot;off&quot;) value = false;
				else value = window.unescape(value);

				parseSearch.cache[url][split[0]] = value;
			}
		}
	}
	return parseSearch.cache[url];
}

const DEFAULT_SETTINGS = {
	color: undefined,
	name: undefined,
	shadows: true,
	debug: false,
};
export function getURLSearchSettings(url = location.href) {
	if (!getURLSearchSettings.cache) getURLSearchSettings.cache = {};

	if (!getURLSearchSettings.cache[url]) {
		let params = parseSearch(url);
		let settings = _clone(DEFAULT_SETTINGS);

		// only trun off the shadows if its set to false
		if (params.shadows === false) settings.shadows = false;

		settings.debug = !!params.debug;

		getURLSearchSettings.cache[url] = settings;
	}

	return getURLSearchSettings.cache[url];
}

export function buildCollisions(collisions) {
	let bodies = [];

	for (let i = 0; i &lt; collisions.length; i++) {
		let object = collisions[i];

		if (!object.visible) continue;

		// create the shape
		if (Array.isArray(object.polygon)) {
			let body = new p2.Body({ mass: 0 });
			body.position[0] = object.x;
			body.position[1] = object.y;
			body.fromPolygon(object.polygon.map(point =&gt; [point.x, point.y]));
			bodies.push(body);
		} else if (Array.isArray(object.polyline)) {
			let body = new p2.Body({ mass: 0 });
			body.position[0] = object.x;
			body.position[1] = object.y;

			// start at the second point
			for (let i = 1; i &lt; object.polyline.length; i++) {
				let prev = object.polyline[i - 1];
				let curr = object.polyline[i];
				let length = Math.sqrt(Math.pow(curr.x - prev.x, 2) + Math.pow(curr.y - prev.y, 2));
				let angle = Math.atan2(curr.y - prev.y, curr.x - prev.x);
				body.addShape(
					new p2.Line({
						position: [lerp(prev.x, curr.x, 0.5), lerp(prev.y, curr.y, 0.5)],
						length: length,
						angle: angle,
					}),
				);
			}

			bodies.push(body);
		} else if (object.height &gt; 0 &amp;&amp; object.width &gt; 0) {
			let body = new p2.Body({ mass: 0 });
			body.position[0] = object.x + object.width / 2;
			body.position[1] = object.y + object.height / 2;
			body.addShape(
				new p2.Box({
					width: object.width,
					height: object.height,
				}),
			);
			bodies.push(body);
		}
	}

	return bodies;
}

export function clipDecimals(v, n = 3) {
	return Math.round(v * Math.pow(10, n)) / Math.pow(10, n);
}
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.0.4)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
